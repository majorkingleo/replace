EXE=replace$(EXTENSION)
PACKAGE=replace
DIST=$(PACKAGE)-$(VERSION)

all: $(EXE)

cpputils/cpputilsshared/libcpputilsshared.a:
	cd cpputils/cpputilsshared && gmake

tools/libtools.a:
	cd tools && gmake

$(EXE): $(OFILES) cpputils/cpputilsshared/libcpputilsshared.a tools/libtools.a
	$(CXX) -o $(EXE) $(CXXFLAGS) $(OFILES) -lcpputilsshared -ltools $(LDFLAGS)

clean_tools:
	 cd cpputils/cpputilsshared && gmake clean
	 cd tools && gmake clean


dist: clean clean_tools
	rm -rf $(DIST)
	rm -f $(DIST).tar.gz
	mkdir $(DIST)
	cp -r $(CFILES) $(HFILES) README genmak configure Makefile.in cpputils tools $(DIST)
	find $(DIST) -name "CVS" -or -name ".svn" | xargs rm -rf
	chmod -R u+w  $(DIST)
	tar cvf $(DIST).tar $(DIST)
	gzip --best $(DIST).tar
	rm -rf $(DIST)

oclean: clean_tools
	 $(RM) core $(OFILES) 
